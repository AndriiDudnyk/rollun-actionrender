# Стандарты

## Стандарт оформления репозитория
    
[pds/skeleton](https://github.com/php-pds/skeleton/blob/1.x/README.md )

Каждое приложение которое требует спецефичиской настройки должно предоставить сооствествующий классы, 
реализующеее `zaboy\installer\Install\InstallerInterface` интерфейс для ее проведения.

Блдее детально о [zaboy-installer](https://github.com/avz-cmf/zaboy-installer).

## Стандарт кодирование

[psr-2](http://www.php-fig.org/psr/psr-2/)

## Станларт наименования контейнеров(инстансов) 

Запущеный Контейнер должен именоваться по принципу `{server_name}-{vm_name}-{container_name}`
>vm-name требуется только в случае если на сервере существуют виртуальные машины.

Имя машины должно храниться в переменной окружения `MACHINE_NAME`
Она должна содержать имя в таком виде  `{server_name}-{vm_name}-{container_name}`.  
В случае если одной составляющей из данной цепочи не существует - пропустите ее.  
Пример:
* `ServerDrakon-ProductionVM-5000`
* `ServerDrakon-ProductionVM-`
* `ServerDrakon--5000`
* `ServerDrakon--`
 

## Стандарт ведения репозитория

Работа с репозиторием осуществляется по средсвам `git-workflow`.

Кратко

Главные ветви:
* develop
* master

Вспомогательные ветви:
* Ветви функциональностей (Feature branches)
* Ветви релизов (Release branches)
* Ветви исправлений (Hotfix branches)

Подробнее можно почитать тут:
 * [Git workflow](https://www.atlassian.com/git/tutorials/comparing-workflows/)
 * [Удачная модель ветвления для Git](https://habrahabr.ru/post/106912/)
 
## Конфиги и переменные окружения 
 
 Все важные и локальные конфигурации мы должны сохранять в перменных окружения, 
 либо как альтернатива в специальном конфиг файле. 
 
 Существует конфигурационный файл `config/env_config.php` который возвращает массив конфигурационных переменных.
 Имеет более низкиц приоритет чем переменная окружения, но возволяет задать настройки 
 там где нет возможности воспользоватся переменной окружения.
 public
 Так же есть файл-скрипт `config/env_configurator.php` который производит иницаилизацию глобальных констант 
 которые берет либо из переменных окружения либо из конфиг файла, в случае если переменная не задана - будет выброшена ошибка.
 
Для того что бы использовать данную возможность вы обязаны поместить `require_once 'config/env_configurator.php';
`в файле входа в приложение. 
 
 Список используемых переменных окружения
 * `APP_ENV` - Указывает тип приложения (может принимать значения `dev/prod`)
 * `MACHINE_NAME` - Указывает имя машины используя шиблон `{server_name}-{vm_name}-{container_name}`.
 * `HOST` - Адрес/домен по которому можно обратится к данному приложению
 * `DB_USER` - Имя пользователя для соединения с DB.
 * `DB_PASS` - Пароль для соединения с DB.
 
 ###Префексы конфигфайлов
 
 Все конфиг файлы должны иметь префикс в виде имени библиотеки либо его сокращения.
 Пример:
 
 * ds - DataStore
 * sm - Service Manager
 
 ## Стандарты имен полей, таблиц
  
 ###Наименование таблиц
 
 * Таблицы нужно называть множественным числом.
 
 * Имена дочерних таблиц == имя родительской таблицы + имя дочерней таблицы, разделенные символом подчеркивания. 
 > Под «дочерней» понимается такая таблица, из которой, при удалении записи в родительской таблице, 
 удаляются все записи имеющие ссылку на удаляемую запись в родительской таблице. 
 
 ###Наименование полей
 
 * Таблицы нужно называть одиночным числом.
 
 * «Имя поля простого типа» — «Составное строчное имя» отражающее содержимое поля.
 
 * «Имя поля ссылочного типа» == наименование таблицы, на которую ссылается данное поле + постфикс «_id». 
 > Исключение составляют случаи, когда есть несколько ссылок на одну и ту же таблицу. 
 В этом случае имя поля формируется как «Имя поля простого типа» + постфикс «_id».
 
 * Поля типа «boolean», принимающие значения 1 или 0 == префикс «flag_» + «Составное строчное имя».
 > «Составное строчное имя» должно отражать содержимое поля, при состоянии флага равному 1.